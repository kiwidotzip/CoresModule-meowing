import { setTimeout } from "../../SBO/utils/functions";
import { SboOverlay, OverlayTextLine, OverlayButton, hoverText } from "../../SBO/utils/overlays";
import cmSettingsData from "../settings";

let potionsOverlay = new SboOverlay("dianaStats", "dianaStatsTracker" , "render", "StatsLoc");
let potionsText = new OverlayTextLine("", true);
let time = 0;
let timerRunning = false;

function potionsTimerOverlay() {
    if (timerRunning) return; // Prevent multiple timers from running at once
    timerRunning = true;

    register("step", () => {
        if (time <= 0) {
            timerRunning = false;
            return; // Stop updating when timer reaches 0
        }

        /*

        let message = "Hello sir!";
        let message2 = "Hello dear sir!";

        potionsOverlay.setLines([
            new OverlayTextLine(message, true),
            new OverlayTextLine(message2, true),
            new OverlayTextLine(`Time left: ${time} min`, true)
        ]);

        */

        let message = `
                        &6&lPotions Timer:  &c&l${time} minutes
                        &c&l${time * 60} seconds
                        &c&l${time * 60 * 1000} milliseconds
                        `;

        potionsOverlay.setLines([
            potionsText.setText(message)
        ]);

        time--; // Decrease time every step
    }).setFps(1); // Runs every second
}


register("command", (t) => {
    time = t;
    if (isNaN(time) || time <= 0) {
        ChatLib.chat("&c&l[Cm] Invalid time! Please enter a positive number.");
        return;
    }

    ChatLib.chat(`&a&l[Cm] Timer Started for ${t} minutes`);
    potionsTimerOverlay();

    setTimeout(() => {
        Client.showTitle("&6Potion Timer", "&6Potions are now gone, drink one again", 0, 25, 35);
        ChatLib.chat(`&c&l[Cm] Timer for ${t} minutes is now OVER, remember to drink your potions!`);
    }, time * 60000);  // Convert minutes to milliseconds


}).setName("potionsTimer");